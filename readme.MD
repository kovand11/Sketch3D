Todo:
make subpolyline reverse safe